<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAN</title>
    <link rel="stylesheet" href="style-Deeplearning8.css">
</head>
<body>
  <div class="content-container">
      <!-- 제목 -->
      <h1 class="left"> GAN </h1>  
      
      <div class="description-section">
          <h2> 생성모델이란? </h2>
          <ul>
              <li><strong>생성 모델(generative model)</strong>은 주어진 데이터를 학습하여 데이터 분포를 따르는 유사한 데이터를 생성하는 모델.</li>
          </ul>
          <h2> 개념 </h2>
          <div class="image-section.left">
              <img src="Deep learning8 images/1.png" alt="1" class="deep-learning-image">
          </div>
          <ul>
              <li>기존 합성곱 신경망에서 다른 이미지 분류, 이미지 검출 등은 입력 이미지(x)가 있을 때 그에 따른 정답(y)을 찾는 것</li>
              <li>예를 들어 개와 고양이 이미지 데이터셋이 주어졌을 때, 그 이미지를 개와 고양이로 분류하는 문제들을 다루었음</li>
              <li>이렇게 이미지를 분류하는 것을 ‘판별(자) 모델(discriminative model)’이라고 함</li>
              <li>일반적으로 판별자 모델에서는 이미지를 정확히 분류(구별)하고자 해당 이미지를 대표하는 특성들을 잘 찾는 것을 목표로 함</li>
              <li>예를 들어 개와 고양이를 구별하려면 개의 귀, 꼬리 등 특성을 찾는 것이 중요함</li>
              <li>판별자 모델에서 추출한 특성들의 조합을 이용하여 새로운 개와 고양이 이미지를 생성할 수 있는데, 이것을 ‘생성(자) 모델(generative model)’이라고 함</li>
              <li>즉, 생성 모델은 입력 이미지에 대한 데이터 분포 p(x)를 학습하여 새로운 이미지(새로운 이미지이면서 기존 이미지에서 특성을 추출했기 때문에 최대한 입력 이미지와 유사한 이미지)를 생성하는 것을 목표로 함</li>
          </ul>

          <h2>  생성 모델의 유형 </h2>
          <div class="image-section.left">
              <img src="Deep learning8 images/2.png" alt="2" class="deep-learning-image">
          </div>
          <ul>
              <li>생성 모델의 유형에는 다음 그림과 같이 모델의 확률 변수를 구하는 ‘변형 오토인코더 모델’과 확률 변수를 이용하지 않는 ‘GAN 모델’이 있음</li>
              <li>변형 오토인코더는 이미지의 잠재 공간(latent space)에서 샘플링하여 완전히 새로운 이미지나 기존 이미지를 변형하는 방식으로 학습을 진행</li>
              <li>GAN은 생성자와 판별자가 서로 경쟁하면서 가짜 이미지를 진짜 이미지와 최대한 비슷하게 만들도록 학습을 진행</li>
          </ul>

          <h2>적대적 생성 신경망(GAN)</h2>
          <div class="image-section.left">
              <img src="Deep learning8 images/main.png" alt="main" class="deep-learning-image">
          </div>
          <ul>
              <li>처음 적대적 생성 신경망(Generative Adversarial Network, GAN)을 제안한 이안 굿펠로우(Ian Goodfellow)는 GAN을 경찰과 위조지폐범 사이의 게임에 비유</li>
              <li>위조지폐범은 진짜와 같은 위조 화폐를 만들어 경찰을 속이고, 경찰은 진짜 화폐와 위조 화폐를 판별하여 위조지폐범을 검거</li>
              <li>위조지폐범과 경찰의 경쟁이 지속되면 어느 순간 위조지폐범은 진짜와 같은 위조지폐를 만들 수 있게 되고, 결국 경찰은 위조지폐와 실제 화폐를 구분할 수 없는 상태에 이르게 됨</li>
              <li>딥러닝 용어로 설명하자면, 경찰은 진짜 지폐와 위조지폐를 구분하는 판별자가 되며 위조지폐범은 위조지폐를 생성하는 생성자가 됨</li>
              <li>생성 모델은 최대한 진짜와 비슷한 데이터를 생성하려는 생성자와 진짜와 가짜를 구별하는 판별자가 각각 존재하여 서로 적대적으로 학습</li>
              <li>적대적 학습에서는 판별자를 먼저 학습시킨 후 생성자를 학습시키는 과정을 반복</li>
              <li>판별자 학습은 크게 두 단계로 진행</li>
          </ul>
          <div class="image-section.left">
              <img src="Deep learning8 images/3.png" alt="3" class="deep-learning-image">
          </div>
          <ul>
              <li>먼저 실제 이미지를 입력해서 네트워크(신경망)가 해당 이미지를 진짜로 분류하도록 학습</li>
              <li>그런 다음 생성자가 생성한 모조 이미지를 입력해서 해당 이미지를 가짜로 분류하도록 학습</li>
              <li>이 과정을 거쳐 판별자는 실제 이미지를 진짜로 분류하고, 모조 이미지를 가짜로 분류</li><br><br>
              <li>이와 같은 학습 과정을 반복하면 판별자와 생성자가 서로를 적대적인 경쟁자로 인식하여 모두 발전하게 됨</li>
              <li>결과적으로 생성자는 진짜 이미지에 완벽히 가까울 정도의 유사한 모조 이미지를 만들고, 이에 따라 판별자는 실제 이미지와 모조 이미지를 구분할 수 없게 됨</li>
              <li>즉, 생성자는 분류에 성공할 확률을 낮추고 판별자는 분류에 성공할 확률을 높이면서 서로 경쟁적으로 발전시키는 구조</li>
          </ul>

          <h2>GAN 동작 원리</h2>          
          <ul>
              <li>적대적 생성 신경망(GAN)은 생성자(Generator)와 판별자(Discriminator) 네트워크 두 개로 구성</li>
              <li>이름에서 알 수 있듯이 두 네트워크는 서로 적대적으로 경쟁하여 학습을 진행</li>
              <li>생성자 G는 판별자 D를 속이려고 원래 이미지와 최대한 비슷한 이미지를 만들도록 학습</li>
              <li>반대로 판별자 D는 원래 이미지와 생성자 G가 만든 이미지를 잘 구분하도록 학습을 진행</li>
          </ul>
          
          <div class="image-section.left">
              <img src="Deep learning8 images/4.png" alt="4" class="deep-learning-image">
          </div>
          <ul>
              <li>먼저 판별자 D부터 살펴보자</li>
              <li>판별자 D의 역할은 주어진 입력 이미지가 진짜 이미지인지 가짜 이미지인지 구별하는 것</li>
              <li>즉, 이미지 x가 입력으로 주어졌을 때 판별자 D의 출력에 해당하는 D(x)가 진짜 이미지일 확률을 반환</li>
          </ul>

          <div class="image-section.left">
              <img src="Deep learning8 images/5.png" alt="5" class="deep-learning-image">
          </div>
          <ul>
              <li>반면 생성자 G의 역할은 판별자 D가 진짜인지 가짜인지 구별할 수 없을 만큼 진짜와 같은 모조 이미지를 노이즈 데이터를 사용하여 만들어 내는 것</li>
              <li>예를 들어 실제 이미지인 알파벳 z가 입력으로 주어졌을 때 판별자는 z를 학습</li>
              <li>또한, 생성자는 임의의 노이즈 데이터를 사용하여 모조 이미지 z'(G(z))를 생성</li>
              <li>G(z)를 다시 판별자 D의 입력으로 주면 판별자는 G(z)가 실제 이미지일 확률을 반환</li>
              <li>실제 데이터를 판단하려고 판별자 D를 학습시킬 때는 생성자 G를 고정시킨 채 실제 이미지는 높은 확률을 반환하는 방향으로, 모조 이미지는 낮은 확률을 반환하는 방향으로 가중치를 업데이트</li><br><br>
              <li>GAN 구조를 살펴보았으니, 이제 GAN의 손실 함수를 살펴보자</li>
              <li>먼저 GAN의 손실 함수는 다음과 같음</li>
              <div class="image-section.left">
                  <img src="Deep learning8 images/6.png" alt="6" class="deep-learning-image">
              </div>
              <li>x &sim; P<sub>data</sub>(x): 실제 데이터에 대한 확률 분포에서 샘플링한 데이터</li>
              <li>z &sim; P<sub>z</sub>(z): 가우시안 분포를 사용하는 임의의 노이즈에서 샘플링한 데이터</li>
              <li>D(x): 판별자 D(x)가 1에 가까우면 진짜 데이터로, 0에 가까우면 가짜 데이터로 판단; 0이면 가짜를 의미</li>
              <li>D(G(z)): 생성자 G가 생성한 이미지인 G(z)가 1에 가까우면 진짜 데이터로, 0에 가까우면 가짜 데이터로 판단</li><br><br>

              <li>수식에서 판별자 D는 실제 이미지 x를 입력받을 경우 𝐷(𝑥)를 1로 예측하고, 생성자가 잠재 벡터에서 생성한 모조 이미지 𝐺(𝑧)를 입력받을 경우 𝐷(𝐺(𝑧))를 0으로 예측</li>
              <li>판별자가 모조 이미지 𝐺(𝑧)를 입력받을 경우 1로 예측하도록 하는 것이 목표</li>
              <li>전체 손실 함수는 복잡하므로 판별자 𝐷와 생성자 𝐺 부분으로 나누어서 살펴보자</li>
              <li>판별자 𝐷는 다음 식의 최댓값으로 파라미터를 업데이트하는 것을 목표로 함</li>
              <li>참고로 판별자는 앞의 수식에서 좌항과 우항을 모두 사용</li>
              <div class="image-section.left">
                  <img src="Deep learning8 images/7.png" alt="7" class="deep-learning-image">
              </div>
              <li>이때 판별자 입장에서는 𝐷(𝑥)=1D(x)=1, 𝐷(𝐺(𝑧))=0이 최상의 결과(진짜 이미지는 1, 가짜 이미지는 0을 출력할 경우)가 될 것이기 때문에 이 식의 최댓값으로 업데이트</li>
              <li>또한, 판별자 입장에서는 log(𝐷(𝑥))log(D(x))와 log⁡(1−𝐷(𝐺(𝑧))) 모두 최댓값이 되어야 함</li>
              <li>즉, 𝐷(𝑥)는 1이 되어야 실제 이미지를 진짜라고 분류하며, 1−𝐷(𝐺(𝑧))는 1이 되어야 생성자가 만든 모조 이미지를 가짜라고 분류</li>
              <li>반면에 생성자 𝐺는 다음 식의 최소값으로 파라미터를 업데이트하는 것을 목표로 함</li>
              <li>이때 생성자 입장에서는 𝐷(𝐺(𝑧))=1이 최상의 결과(판별자가 가짜 이미지를 1로 출력한 경우)가 될 것이기 때문에 이 식의 최소값으로 업데이트</li>
              <div class="image-section.left">
                  <img src="Deep learning8 images/8.png" alt="8" class="deep-learning-image">
              </div>
              <li>참고로 GAN을 학습시키려면 판별자와 생성자의 파라미터를 번갈아 가며 업데이트</li>
              <li>또한, 판별자의 파라미터를 업데이트할 때는 생성자의 파라미터를 고정시키고, 생성자의 파라미터를 업데이트할 때는 판별자의 파라미터를 고정</li>
          </ul>          

          <div class="image-section.left">
              <img src="Deep learning8 images/9.png" alt="9" class="deep-learning-image">
          </div>
          <ul>
              <h4>데이터 전처리</h4>
              <li><code>transforms.Normalize((0.5,), (0.5,))</code>: GAN의 생성자와 판별자가 데이터의 값 범위를 동일하게 학습하도록 MNIST 데이터를 -1 ~ 1 범위로 정규화.</li>
              <h4>MNIST 데이터셋 로드</h4>
              <li><code>datasets.MNIST(root="./data", train=True, transform=transform, download=True)</code>: GAN 학습에 사용할 학습 데이터(MNIST)를 다운로드하고, 전처리를 적용.</li>
              <h4>DataLoader</h4>
              <li><code>DataLoader(train_dataset, batch_size=512, shuffle=True)</code>: GAN 학습에서 데이터가 배치 단위로 로드되며, 데이터 순서가 섞여 다양한 패턴을 학습 가능하도록 설정.</li>
          </ul>
      </div>
  </div>   
</body>
</html>
